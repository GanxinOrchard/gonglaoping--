<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="pageTitle">商品詳情 - 柑心果園</title>
    <meta name="description" id="pageDescription" content="柑心果園優質農產品，產地直送，新鮮安心。">
    <link rel="stylesheet" href="./css/main.css?v=20251103180">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://unpkg.com/aos@2.3.1/dist/aos.css">
    
    <!-- 商品詳情頁專用樣式 -->
    <link rel="stylesheet" href="./css/product-detail-page.css?v=20251103180">
    
    <style>
        /* 評論區樣式 */
        .reviews-section {
            background: white;
            padding: 60px 0;
        }
        
        .reviews-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        .section-title {
            text-align: center;
            font-size: 2.5rem;
            font-weight: 900;
            color: #333;
            margin-bottom: 40px;
        }
        
        .review-stats {
            text-align: center;
            background: #f8f8f8;
            padding: 30px;
            border-radius: 12px;
            margin-bottom: 40px;
        }
        
        .review-stats .rating-large {
            font-size: 3rem;
            color: #ff6b35;
            font-weight: 900;
            margin-bottom: 10px;
        }
        
        .review-stats .stars {
            font-size: 1.8rem;
            color: #FFD700;
            margin-bottom: 10px;
        }
        
        .review-stats .review-count {
            font-size: 1rem;
            color: #666;
        }
        
        #reviewsList {
            display: grid;
            gap: 20px;
        }
        
        .review-item {
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 12px;
            padding: 25px;
            transition: all 0.3s;
        }
        
        .review-item:hover {
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            transform: translateY(-2px);
        }
        
        .review-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .review-user {
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 600;
            color: #333;
        }
        
        .review-user i {
            font-size: 1.5rem;
            color: #ff6b35;
        }
        
        .review-rating {
            color: #FFD700;
            font-size: 1.2rem;
        }
        
        .review-date {
            font-size: 0.9rem;
            color: #999;
            margin-bottom: 15px;
        }
        
        .review-content {
            font-size: 1rem;
            line-height: 1.6;
            color: #555;
        }
        
        /* 常見問題樣式 */
        .faq-section {
            background: #f8f8f8;
            padding: 60px 0;
        }
        
        .faq-container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        .faq-item {
            background: white;
            border-radius: 12px;
            margin-bottom: 20px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        .faq-question {
            padding: 20px 25px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: 600;
            color: #333;
            transition: all 0.3s;
        }
        
        .faq-question:hover {
            background: #fff5f0;
        }
        
        .faq-question i {
            color: #ff6b35;
            transition: transform 0.3s;
        }
        
        .faq-question.active i {
            transform: rotate(180deg);
        }
        
        .faq-answer {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }
        
        .faq-answer.active {
            max-height: 500px;
        }
        
        .faq-answer-content {
            padding: 0 25px 20px 25px;
            color: #666;
            line-height: 1.8;
        }
        
        /* 物流配送樣式 */
        .shipping-section {
            background: white;
            padding: 60px 0;
        }
        
        .shipping-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        .shipping-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin-top: 40px;
        }
        
        .shipping-card {
            background: #f8f8f8;
            border-radius: 12px;
            padding: 30px;
            text-align: center;
            transition: all 0.3s;
        }
        
        .shipping-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        
        .shipping-card i {
            font-size: 3rem;
            color: #ff6b35;
            margin-bottom: 20px;
        }
        
        .shipping-card h3 {
            font-size: 1.5rem;
            margin-bottom: 15px;
            color: #333;
        }
        
        .shipping-card p {
            color: #666;
            line-height: 1.6;
        }
        
        /* 推薦商品樣式 */
        .recommended-section {
            background: #f8f8f8;
            padding: 60px 0;
        }
        
        .recommended-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        .recommended-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 30px;
            margin-top: 40px;
        }
        
        .recommended-card {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            transition: all 0.3s;
            cursor: pointer;
        }
        
        .recommended-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.15);
        }
        
        .recommended-card img {
            width: 100%;
            height: 250px;
            object-fit: cover;
        }
        
        .recommended-card-content {
            padding: 20px;
        }
        
        .recommended-card h3 {
            font-size: 1.3rem;
            margin-bottom: 10px;
            color: #333;
        }
        
        .recommended-card .price {
            font-size: 1.5rem;
            font-weight: 900;
            color: #ff6b35;
            margin-bottom: 15px;
        }
        
        .recommended-card .btn-view {
            width: 100%;
            padding: 12px;
            background: linear-gradient(135deg, #ff6b35, #f7931e);
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .recommended-card .btn-view:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 20px rgba(255,107,53,0.4);
        }
    </style>
</head>
<body>
    <div id="header-container"></div>
    <div id="mobile-menu-container"></div>

    <main id="main-content">
        <!-- 麵包屑 -->
        <div class="breadcrumb-container">
            <div class="container">
                <nav class="breadcrumb">
                    <a href="index.html">首頁</a>
                    <span class="separator">/</span>
                    <a href="products.html">全部商品</a>
                    <span class="separator">/</span>
                    <span id="breadcrumbProductName">商品詳情</span>
                </nav>
            </div>
        </div>

        <!-- 商品詳情主要內容 -->
        <div id="productDetailContainer" class="container" style="padding: 40px 20px;">
            <!-- 商品內容將由 JS 動態載入 -->
        </div>

        <!-- 物流配送資訊 -->
        <section class="shipping-section">
            <div class="shipping-container">
                <h2 class="section-title">物流配送資訊</h2>
                <div class="shipping-grid">
                    <div class="shipping-card" data-aos="fade-up" data-aos-delay="0">
                        <i class="fas fa-shipping-fast"></i>
                        <h3>宅配到府</h3>
                        <p>3-5 個工作天送達<br>運費 NT$ 100<br>滿 $1000 免運費</p>
                    </div>
                    <div class="shipping-card" data-aos="fade-up" data-aos-delay="100">
                        <i class="fas fa-hand-holding"></i>
                        <h3>到店自取</h3>
                        <p>預約後到店取貨<br>免運費<br>彈性取貨時間</p>
                    </div>
                    <div class="shipping-card" data-aos="fade-up" data-aos-delay="200">
                        <i class="fas fa-box"></i>
                        <h3>包裝保證</h3>
                        <p>專業包裝<br>保證新鮮送達<br>破損包退換</p>
                    </div>
                    <div class="shipping-card" data-aos="fade-up" data-aos-delay="300">
                        <i class="fas fa-snowflake"></i>
                        <h3>低溫配送</h3>
                        <p>冷凍商品專用<br>全程低溫運送<br>品質保證</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- 常見問題 -->
        <section class="faq-section">
            <div class="faq-container">
                <h2 class="section-title">常見問題</h2>
                
                <div class="faq-item" data-aos="fade-up">
                    <div class="faq-question" onclick="toggleFAQ(this)">
                        <span><i class="fas fa-question-circle"></i> 商品如何保存？</span>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="faq-answer">
                        <div class="faq-answer-content">
                            新鮮水果建議放置於陰涼處或冰箱冷藏，避免陽光直射。椪柑可在室溫保存約一週，冷藏可延長至兩週。茂谷柑建議冷藏保存。冷凍商品（菱角、芋角）請保持冷凍狀態，可保存 3-6 個月。
                        </div>
                    </div>
                </div>

                <div class="faq-item" data-aos="fade-up" data-aos-delay="50">
                    <div class="faq-question" onclick="toggleFAQ(this)">
                        <span><i class="fas fa-question-circle"></i> 如何確保商品新鮮度？</span>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="faq-answer">
                        <div class="faq-answer-content">
                            我們堅持產地直送，從果園到您手中最快 24 小時。所有商品在出貨前都經過嚴格品檢，確保品質。新鮮水果採現採現配，冷凍商品全程低溫運送，保證最佳品質。
                        </div>
                    </div>
                </div>

                <div class="faq-item" data-aos="fade-up" data-aos-delay="100">
                    <div class="faq-question" onclick="toggleFAQ(this)">
                        <span><i class="fas fa-question-circle"></i> 可以指定送達日期嗎？</span>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="faq-answer">
                        <div class="faq-answer-content">
                            可以的！在結帳時您可以在備註欄填寫希望送達的日期和時間，我們會盡力配合。但請注意，實際送達時間可能因物流狀況有所調整。建議提前 2-3 天下單以確保準時送達。
                        </div>
                    </div>
                </div>

                <div class="faq-item" data-aos="fade-up" data-aos-delay="150">
                    <div class="faq-question" onclick="toggleFAQ(this)">
                        <span><i class="fas fa-question-circle"></i> 收到商品有問題怎麼辦？</span>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="faq-answer">
                        <div class="faq-answer-content">
                            如收到商品有任何問題（如破損、變質等），請立即拍照並聯繫我們客服（LINE ID: @ganxinorchard）。我們提供 7 天鑑賞期，確保您的權益。符合退換貨條件的商品，我們將立即處理退款或補寄。
                        </div>
                    </div>
                </div>

                <div class="faq-item" data-aos="fade-up" data-aos-delay="200">
                    <div class="faq-question" onclick="toggleFAQ(this)">
                        <span><i class="fas fa-question-circle"></i> 付款方式有哪些？</span>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="faq-answer">
                        <div class="faq-answer-content">
                            我們提供多種付款方式：<br>
                            1. 銀行轉帳（下單後 3 天內完成轉帳）<br>
                            2. Line Pay（線上即時付款，方便快速）<br>
                            轉帳資訊會在訂單確認信中提供。
                        </div>
                    </div>
                </div>

                <div class="faq-item" data-aos="fade-up" data-aos-delay="250">
                    <div class="faq-question" onclick="toggleFAQ(this)">
                        <span><i class="fas fa-question-circle"></i> 大量訂購有優惠嗎？</span>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="faq-answer">
                        <div class="faq-answer-content">
                            有的！如需大量訂購（20 箱以上），請直接聯繫我們客服，我們可以提供更優惠的價格和客製化包裝服務。適合企業送禮、團購等需求。
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 顧客評論 -->
        <section class="reviews-section">
            <div class="reviews-container">
                <h2 class="section-title">顧客評論</h2>
                
                <div class="review-stats" data-aos="fade-up">
                    <div class="rating-large" id="averageRating">4.9</div>
                    <div class="stars" id="reviewStars">★★★★★</div>
                    <div class="review-count">(0 則評論)</div>
                </div>
                
                <div id="reviewsList">
                    <!-- 評論將由 JS 動態載入 -->
                </div>
                
                <div style="text-align: center; margin-top: 40px;">
                    <button class="btn-load-more" onclick="loadMoreReviews()" style="
                        padding: 15px 40px;
                        background: linear-gradient(135deg, #ff6b35, #f7931e);
                        color: white;
                        border: none;
                        border-radius: 50px;
                        font-size: 1rem;
                        font-weight: 600;
                        cursor: pointer;
                        transition: all 0.3s;
                    ">載入更多評論</button>
                </div>
            </div>
        </section>

        <!-- 您可能也喜歡 -->
        <section class="recommended-section">
            <div class="recommended-container">
                <h2 class="section-title">您可能也喜歡</h2>
                <div class="recommended-grid" id="recommendedProducts">
                    <!-- 推薦商品將由 JS 動態載入 -->
                </div>
            </div>
        </section>
    </main>

    <div id="footer-container"></div>

    <!-- AOS 動畫 -->
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script>
        AOS.init({
            duration: 800,
            once: true,
            offset: 100
        });
    </script>
    
    <!-- 核心 JS -->
    <script src="./js/template-loader.js"></script>
    <script src="./js/mobile-menu-simple.js" defer></script>
    <script src="./js/dropdown-menu.js" defer></script>
    
    <!-- 功能 JS -->
    <script src="./js/cart.js?v=20251103180"></script>
    <script src="./js/products.js?v=20251103180"></script>
    <script src="./js/product-detail.js?v=20251103180"></script>
    <script src="./js/product-gallery.js?v=20251103180" defer></script>
    <script src="./js/reviews.js?v=20251103180"></script>
    <script src="./js/auto-sales.js?v=20251103180" defer></script>
    
    <!-- 其他功能 -->
    <script src="./js/main.js" defer></script>
    
    <!-- FAQ 互動 -->
    <script>
        function toggleFAQ(element) {
            const faqItem = element.parentElement;
            const answer = faqItem.querySelector('.faq-answer');
            const allFAQs = document.querySelectorAll('.faq-item');
            
            // 關閉其他FAQ
            allFAQs.forEach(item => {
                if (item !== faqItem) {
                    item.querySelector('.faq-question').classList.remove('active');
                    item.querySelector('.faq-answer').classList.remove('active');
                }
            });
            
            // 切換當前FAQ
            element.classList.toggle('active');
            answer.classList.toggle('active');
        }
        
        // 渲染推薦商品
        function renderRecommendedProducts() {
            const urlParams = new URLSearchParams(window.location.search);
            const currentProductId = parseInt(urlParams.get('id'));
            
            if (typeof products === 'undefined') {
                console.warn('products 資料尚未載入');
                return;
            }
            
            // 獲取其他商品（最多4個）
            const recommended = products
                .filter(p => p.id !== currentProductId)
                .slice(0, 4);
            
            const container = document.getElementById('recommendedProducts');
            container.innerHTML = recommended.map(product => `
                <div class="recommended-card" onclick="location.href='product-detail.html?id=${product.id}'" data-aos="fade-up">
                    <img src="${product.image}" alt="${product.name}">
                    <div class="recommended-card-content">
                        <h3>${product.name}</h3>
                        <div class="price">NT$ ${product.price.toLocaleString()}</div>
                        <button class="btn-view">查看詳情</button>
                    </div>
                </div>
            `).join('');
        }
        
        // 頁面載入後執行
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', () => {
                setTimeout(renderRecommendedProducts, 500);
            });
        } else {
            setTimeout(renderRecommendedProducts, 500);
        }
    </script>
</body>
</html>
