# 🎯 最終方案 - 使用指南

## ✅ 結論：使用哪個系統？

### 推薦使用：`GAS-分頁管理-GitHub版.gs` ⭐

**這是專為 GitHub 架構設計的最終版本！**

---

## 📊 三個 GAS 檔案比較

| 檔案名稱 | 用途 | 是否使用 |
|---------|------|---------|
| `GAS-後台管理完整版.gs` | 舊版，通用後台 | ❌ 不用，可刪除 |
| `GAS-分頁管理完整版.gs` | 分頁管理，但用 Drive | ❌ 不用，架構不對 |
| `GAS-分頁管理-GitHub版.gs` | 分頁管理 + GitHub | ✅ **使用這個！** |

### 為什麼選擇 GitHub 版？

```
✅ 圖片存在 GitHub（不需要 Drive）
✅ 路徑管理正確（GitHub 路徑）
✅ 匯出 JSON 供前端使用
✅ 可選的 GitHub API 推送
✅ 完整的 18 個工作表
```

---

## 🏗️ 正確的系統架構

```
┌─────────────────────────────────────┐
│  管理者（您）                         │
└──────────────┬──────────────────────┘
               ↓
┌─────────────────────────────────────┐
│  Google Sheets（後台管理）           │
│  ┌─────────────────────────────┐   │
│  │  18個工作表                   │   │
│  │  - 【首頁管理】               │   │
│  │  - 【最新消息管理】           │   │
│  │  - 【商品管理】等...          │   │
│  └─────────────────────────────┘   │
│            ↓                         │
│  ┌─────────────────────────────┐   │
│  │  Google Apps Script          │   │
│  │  - 自動生成 ID               │   │
│  │  - 自動生成路徑              │   │
│  │  - 匯出 JSON                 │   │
│  └─────────────────────────────┘   │
└──────────────┬──────────────────────┘
               ↓
        下載 JSON 檔案
               ↓
┌─────────────────────────────────────┐
│  本地電腦                            │
│  ┌─────────────────────────────┐   │
│  │  專案資料夾                   │   │
│  │  ├── data/                   │   │
│  │  │   └── pages-data.json     │   │
│  │  └── images/                 │   │
│  │      └── pages/              │   │
│  │          ├── news/           │   │
│  │          └── products/       │   │
│  └─────────────────────────────┘   │
│            ↓                         │
│  ┌─────────────────────────────┐   │
│  │  Git 操作                     │   │
│  │  git add .                   │   │
│  │  git commit -m "更新"        │   │
│  │  git push                    │   │
│  └─────────────────────────────┘   │
└──────────────┬──────────────────────┘
               ↓
┌─────────────────────────────────────┐
│  GitHub 倉庫                         │
│  ganxinorchard/gonglaoping--        │
│  ┌─────────────────────────────┐   │
│  │  data/pages-data.json        │   │
│  │  images/pages/...            │   │
│  └─────────────────────────────┘   │
└──────────────┬──────────────────────┘
               ↓ 自動部署
┌─────────────────────────────────────┐
│  GitHub Pages（前端網站）            │
│  https://ganxinorchard.github.io    │
│  ┌─────────────────────────────┐   │
│  │  JavaScript 讀取 JSON         │   │
│  │  fetch('data/pages-data.json')│   │
│  │  動態顯示內容                 │   │
│  └─────────────────────────────┘   │
└─────────────────────────────────────┘
```

---

## 📝 完整工作流程

### 情境 1：發布新文章（含圖片）

#### Step 1：準備圖片（本地）
```bash
# 在專案資料夾整理圖片
C:\Users\張-1\CascadeProjects\ganxin-orchard\images\pages\news\articles\2025-01\
└── article-001-cover.jpg
```

#### Step 2：後台輸入內容
```
1. 開啟 Google Sheets
2. 到【最新消息管理】工作表
3. 新增一行：
   - 標題：2025春季椪柑上市
   - 分類：新品上市
   - 內容：今年春季椪柑品質特別好...
   （封面圖欄位暫時留空）
```

#### Step 3：發布文章
```
1. 點選選單：📰 發布新文章
2. 系統自動：
   ✅ 生成文章ID：NEWS1737639000000
   ✅ 生成路徑：images/pages/news/articles/2025-01/NEWS1737639000000-cover.jpg
   ✅ 設定發布日期
   ✅ 狀態改為「已發布」
3. 彈出訊息，告訴您圖片路徑
```

#### Step 4：重新命名圖片
```bash
# 根據系統給的 ID 重新命名
article-001-cover.jpg 
→ NEWS1737639000000-cover.jpg
```

#### Step 5：上傳到 GitHub
```bash
cd C:\Users\張-1\CascadeProjects\ganxin-orchard
git add images/pages/news/articles/2025-01/
git commit -m "新增文章封面圖"
git push
```

#### Step 6：匯出資料
```
1. 點選選單：📊 匯出 JSON 資料
2. 下載 pages-data.json
3. 放到本地專案：data/pages-data.json
```

#### Step 7：推送資料
```bash
git add data/pages-data.json
git commit -m "更新文章資料"
git push
```

#### Step 8：完成！
```
GitHub Pages 自動部署（約 1-2 分鐘）
→ 網站上就能看到新文章了！
```

---

### 情境 2：上架新商品

#### Step 1：準備商品圖
```bash
images\pages\products\items\ponkan\
└── 準備好商品圖片
    ├── temp-main.jpg
    ├── temp-detail-1.jpg
    └── temp-detail-2.jpg
```

#### Step 2：後台輸入
```
【商品管理】工作表新增：
- 商品名稱：特級椪柑 5斤裝
- 分類：椪柑
- 價格：600
- 庫存：100
- 描述：精選特級椪柑...
```

#### Step 3：上架
```
點選：🛍️  上架新商品
→ 生成商品ID：PROD1737639100000
→ 生成路徑：images/pages/products/items/ponkan/PROD1737639100000-main.jpg
```

#### Step 4：重新命名並上傳
```bash
# 重新命名
temp-main.jpg → PROD1737639100000-main.jpg
temp-detail-1.jpg → PROD1737639100000-detail-1.jpg

# 上傳
git add images/pages/products/
git commit -m "新增椪柑商品圖"
git push
```

#### Step 5：匯出並推送資料
```bash
# 匯出 JSON
# 下載後放到 data/
git add data/pages-data.json
git commit -m "新增商品資料"
git push
```

---

## 🎯 簡化版工作流程

### 日常更新內容（不含圖片）

```
1. Google Sheets 修改內容
2. 匯出 JSON
3. Git 推送
4. 完成！
```

### 新增內容（含圖片）

```
1. 準備圖片（本地）
2. Google Sheets 新增資料 → 發布/上架
3. 根據生成的 ID 重新命名圖片
4. Git 推送圖片
5. 匯出 JSON
6. Git 推送資料
7. 完成！
```

---

## 🛠️ 設定步驟

### 1. 建立 Google Sheets

```
1. 前往 https://sheets.google.com
2. 建立新試算表：柑心果園-分頁管理系統
3. 記錄網址
```

### 2. 設定 Apps Script

```
1. 擴充功能 → Apps Script
2. 複製 backend/GAS-分頁管理-GitHub版.gs 內容
3. 貼上、儲存
4. 執行 onOpen 授權
```

### 3. 修改配置（重要）

```javascript
// 在 GAS 程式碼開頭修改：
const CONFIG = {
  github: {
    owner: 'ganxinorchard',              // ✅ 您的 GitHub 用戶名
    repo: 'gonglaoping--',                // ✅ 您的倉庫名稱
    branch: 'main',                       // ✅ 分支名稱
    token: '',                            // ⚠️  可選：填入 Token 可自動推送
    baseUrl: 'https://ganxinorchard.github.io/gonglaoping--/'
  }
};
```

### 4. 初始化系統

```
1. 重新載入 Google Sheets
2. 點選選單：⚙️  初始化系統
3. 等待建立 18 個工作表
4. 完成！
```

---

## 📋 18 個工作表說明

### 內容管理（14個）
1. 【首頁管理】- 輪播、區塊
2. 【最新消息管理】- 文章（⭐ 自動發布）
3. 【關於我們管理】- 團隊、果園
4. 【商品管理】- 商品（⭐ 自動上架）
5. 【產季管理】- 產季資訊
6. 【指南管理】- 選購指南
7. 【分級管理】- 規格分級
8. 【聯絡我們管理】- 聯絡資訊
9. 【農場介紹管理】- 農場資訊
10. 【知識百科管理】- 知識文章
11. 【購物車管理】- 購物車設定
12. 【結帳流程管理】- 結帳設定
13. 【訂單管理】- 訂單設定
14. 【政策管理】- 政策內容

### 系統管理（4個）
15. 【圖片路徑記錄】- 記錄所有圖片路徑
16. 【SEO設定】- 全站 SEO
17. 【全域設定】- 網站設定
18. 【操作記錄】- 操作追蹤

---

## 💡 進階：GitHub API 自動推送（可選）

如果您想要**點一下按鈕就自動推送到 GitHub**：

### 設定 GitHub Token

```
1. 前往 GitHub → Settings → Developer settings
2. Personal access tokens → Tokens (classic)
3. Generate new token
4. 勾選權限：repo（完整權限）
5. 複製 Token
6. 在 GAS 中填入 CONFIG.github.token
```

### 使用方式

```
修改內容後 → 點選「📤 推送到 GitHub」→ 自動推送！
```

**注意**：Token 需妥善保管，不要分享給他人。

---

## 🎉 最終確認

### ✅ 需要的檔案

- **GAS-分頁管理-GitHub版.gs** ← 使用這個
- **建立分頁圖片結構.py** ← 建立資料夾
- **分頁管理系統-快速開始.md** ← 操作指南

### ❌ 可以刪除的檔案

- GAS-後台管理完整版.gs（舊版）
- GAS-分頁管理完整版.gs（用 Drive 的版本）
- 重組圖片資料夾.py（舊的圖片重組，不適用）

### 📁 圖片存放位置

```
✅ 正確：GitHub 倉庫的 images/ 資料夾
❌ 錯誤：Google Drive
```

### 🔄 更新流程

```
Google Sheets 編輯
    ↓
匯出 JSON
    ↓
Git 推送到 GitHub
    ↓
GitHub Pages 自動部署
```

---

## 📞 常見問題

### Q1：為什麼不用 Google Drive？

**A：** 因為圖片需要在 GitHub Pages 網站上顯示，放在 GitHub 倉庫中路徑最簡單，而且有版本控制。

### Q2：可以在 GitHub Pages 架設後台嗎？

**A：** 可以架設**顯示介面**，但無法做到：
- ❌ 直接編輯資料（需要伺服器）
- ❌ 上傳檔案（需要後端）
- ✅ 可以顯示資料（讀取 JSON）

### Q3：一定要用 Git 嗎？

**A：** 是的，因為 GitHub Pages 就是基於 Git。但您可以：
- 使用命令列（git add, commit, push）
- 使用 GitHub Desktop（視覺化介面）
- 使用 VS Code 內建的 Git 功能

### Q4：可以完全自動化嗎？

**A：** 可以！使用 GitHub Token 後：
```
Google Sheets 編輯 
→ 點選「推送到 GitHub」
→ 自動推送！
```

但圖片還是需要手動上傳（或使用 GitHub API）。

---

## 🚀 立即開始

### Step 1：建立圖片結構
```bash
python 建立分頁圖片結構.py
```

### Step 2：設定後台
```
1. 建立 Google Sheets
2. 設定 Apps Script（使用 GitHub 版）
3. 初始化系統
```

### Step 3：測試
```
1. 新增一筆測試資料
2. 發布/上架
3. 匯出 JSON
4. Git 推送
5. 檢查網站
```

---

**準備好了嗎？開始使用 GitHub 版本的分頁管理系統！** 🎉

**使用檔案**：`backend/GAS-分頁管理-GitHub版.gs`

**參考文檔**：
- GAS系統說明與GitHub方案.md
- 分頁管理系統-快速開始.md
- 分頁管理對照表.md
