<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¸…é™¤å¿«å–ä¸¦æ¸¬è©¦ - æŸ‘å¿ƒæœåœ’</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #ff8c42;
        }
        .step {
            margin: 20px 0;
            padding: 15px;
            background: #fff7ed;
            border-left: 4px solid #ff8c42;
            border-radius: 5px;
        }
        .btn {
            display: inline-block;
            padding: 12px 24px;
            background: #ff8c42;
            color: white;
            text-decoration: none;
            border-radius: 5px;
            margin: 10px 5px;
            cursor: pointer;
            border: none;
            font-size: 16px;
        }
        .btn:hover {
            background: #e67a32;
        }
        .status {
            margin: 20px 0;
            padding: 15px;
            background: #f0fdf4;
            border-left: 4px solid #10b981;
            border-radius: 5px;
        }
        .error {
            background: #fef2f2;
            border-left-color: #ef4444;
        }
        code {
            background: #f3f4f6;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: monospace;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”§ æ¸…é™¤å¿«å–ä¸¦æ¸¬è©¦</h1>
        
        <div class="step">
            <h3>æ­¥é©Ÿ 1: æ¸…é™¤ç€è¦½å™¨å¿«å–</h3>
            <p>è«‹æŒ‰ä»¥ä¸‹å¿«æ·éµæ¸…é™¤å¿«å–ï¼š</p>
            <ul>
                <li><strong>Chrome/Edge</strong>: Ctrl + Shift + Delete</li>
                <li><strong>Firefox</strong>: Ctrl + Shift + Delete</li>
                <li>é¸æ“‡ã€Œå¿«å–çš„åœ–ç‰‡å’Œæª”æ¡ˆã€</li>
                <li>æ™‚é–“ç¯„åœé¸ã€Œæ‰€æœ‰æ™‚é–“ã€</li>
                <li>é»æ“Šã€Œæ¸…é™¤è³‡æ–™ã€</li>
            </ul>
        </div>

        <div class="step">
            <h3>æ­¥é©Ÿ 2: å¼·åˆ¶é‡æ–°æ•´ç†</h3>
            <p>æ¸…é™¤å¿«å–å¾Œï¼ŒæŒ‰ <code>Ctrl + F5</code> å¼·åˆ¶é‡æ–°æ•´ç†é é¢</p>
        </div>

        <div class="step">
            <h3>æ­¥é©Ÿ 3: è‡ªå‹•æ¸…é™¤å¿«å–</h3>
            <button class="btn" onclick="clearAllCache()">é»æ“Šæ¸…é™¤æ‰€æœ‰å¿«å–</button>
            <p id="clearStatus"></p>
        </div>

        <div class="step">
            <h3>æ­¥é©Ÿ 4: æ¸¬è©¦åŠŸèƒ½</h3>
            <button class="btn" onclick="testCart()">æ¸¬è©¦è³¼ç‰©è»Š</button>
            <button class="btn" onclick="testProducts()">æ¸¬è©¦å•†å“è¼‰å…¥</button>
            <div id="testResults"></div>
        </div>

        <div class="step">
            <h3>æ­¥é©Ÿ 5: å‰å¾€ç¶²ç«™</h3>
            <a href="index.html" class="btn">å‰å¾€é¦–é </a>
            <a href="https://ganxinorchard.github.io/gonglaoping--/" class="btn" target="_blank">å‰å¾€ç·šä¸Šç¶²ç«™</a>
        </div>

        <div class="step">
            <h3>ğŸ” é™¤éŒ¯è³‡è¨Š</h3>
            <p>é–‹å•Ÿç€è¦½å™¨æ§åˆ¶å°ï¼ˆF12ï¼‰æŸ¥çœ‹éŒ¯èª¤è¨Šæ¯</p>
            <button class="btn" onclick="showDebugInfo()">é¡¯ç¤ºé™¤éŒ¯è³‡è¨Š</button>
            <div id="debugInfo"></div>
        </div>
    </div>

    <!-- è¼‰å…¥å¿…è¦çš„ JS æª”æ¡ˆ -->
    <script src="./js/products.js"></script>
    <script src="./js/cart.js"></script>
    
    <script>
        // æ¸…é™¤æ‰€æœ‰å¿«å–
        function clearAllCache() {
            const statusEl = document.getElementById('clearStatus');
            
            try {
                // æ¸…é™¤ localStorage
                localStorage.clear();
                
                // æ¸…é™¤ sessionStorage
                sessionStorage.clear();
                
                // æ¸…é™¤ Service Worker å¿«å–
                if ('caches' in window) {
                    caches.keys().then(function(names) {
                        for (let name of names) {
                            caches.delete(name);
                        }
                    });
                }
                
                statusEl.innerHTML = '<div class="status">âœ… å¿«å–å·²æ¸…é™¤ï¼è«‹æŒ‰ Ctrl+F5 é‡æ–°æ•´ç†é é¢</div>';
                
                // 3ç§’å¾Œè‡ªå‹•é‡æ–°æ•´ç†
                setTimeout(() => {
                    window.location.reload(true);
                }, 3000);
                
            } catch (error) {
                statusEl.innerHTML = '<div class="status error">âŒ æ¸…é™¤å¤±æ•—ï¼š' + error.message + '</div>';
            }
        }

        // æ¸¬è©¦è³¼ç‰©è»Š
        function testCart() {
            const resultsEl = document.getElementById('testResults');
            let results = '<div class="status"><h4>è³¼ç‰©è»Šæ¸¬è©¦çµæœï¼š</h4><ul>';
            
            // æª¢æŸ¥ cart.js æ˜¯å¦è¼‰å…¥
            if (typeof addToCart === 'function') {
                results += '<li>âœ… addToCart å‡½æ•¸å­˜åœ¨</li>';
            } else {
                results += '<li>âŒ addToCart å‡½æ•¸ä¸å­˜åœ¨</li>';
            }
            
            if (typeof cart !== 'undefined') {
                results += '<li>âœ… cart è®Šæ•¸å­˜åœ¨</li>';
            } else {
                results += '<li>âŒ cart è®Šæ•¸ä¸å­˜åœ¨</li>';
            }
            
            if (typeof updateCartUI === 'function') {
                results += '<li>âœ… updateCartUI å‡½æ•¸å­˜åœ¨</li>';
            } else {
                results += '<li>âŒ updateCartUI å‡½æ•¸ä¸å­˜åœ¨</li>';
            }
            
            results += '</ul></div>';
            resultsEl.innerHTML = results;
        }

        // æ¸¬è©¦å•†å“è¼‰å…¥
        function testProducts() {
            const resultsEl = document.getElementById('testResults');
            let results = '<div class="status"><h4>å•†å“æ¸¬è©¦çµæœï¼š</h4><ul>';
            
            if (typeof products !== 'undefined') {
                results += '<li>âœ… products é™£åˆ—å­˜åœ¨</li>';
                results += '<li>å•†å“æ•¸é‡ï¼š' + products.length + '</li>';
                
                products.forEach(p => {
                    results += '<li>å•†å“ ' + p.id + ': ' + p.name + ' (é‹è²»é¡å‹: ' + p.shippingType + ')</li>';
                });
            } else {
                results += '<li>âŒ products é™£åˆ—ä¸å­˜åœ¨</li>';
            }
            
            results += '</ul></div>';
            resultsEl.innerHTML = results;
        }

        // é¡¯ç¤ºé™¤éŒ¯è³‡è¨Š
        function showDebugInfo() {
            const debugEl = document.getElementById('debugInfo');
            let info = '<div class="status"><h4>ç³»çµ±è³‡è¨Šï¼š</h4><ul>';
            
            info += '<li>ç€è¦½å™¨ï¼š' + navigator.userAgent + '</li>';
            info += '<li>ç•¶å‰ç¶²å€ï¼š' + window.location.href + '</li>';
            info += '<li>localStorage é …ç›®æ•¸ï¼š' + localStorage.length + '</li>';
            info += '<li>sessionStorage é …ç›®æ•¸ï¼š' + sessionStorage.length + '</li>';
            
            // æª¢æŸ¥æ˜¯å¦æœ‰éŒ¯èª¤
            window.onerror = function(msg, url, line) {
                info += '<li class="error">âŒ JavaScript éŒ¯èª¤ï¼š' + msg + ' (è¡Œ ' + line + ')</li>';
            };
            
            info += '</ul></div>';
            debugEl.innerHTML = info;
        }

        // è‡ªå‹•æª¢æŸ¥
        window.addEventListener('load', function() {
            console.log('=== æŸ‘å¿ƒæœåœ’é™¤éŒ¯å·¥å…· ===');
            console.log('è«‹é»æ“ŠæŒ‰éˆ•é€²è¡Œæ¸¬è©¦');
        });
    </script>
</body>
</html>
