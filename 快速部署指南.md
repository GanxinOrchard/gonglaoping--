# 🚀 Google Apps Script 快速部署指南

## 📝 步驟 1：創建 Google Sheets

1. 開啟瀏覽器，前往：https://sheets.google.com
2. 點擊「空白」創建新試算表
3. 將試算表命名為：**柑心果園訂單管理系統**
4. 創建以下工作表（點擊左下角的 + 號）：
   - `訂單`
   - `明細`
   - `聯絡表單` ⭐ 新增
   - `出貨統計`
   - `週出貨統計`
   - `規格統計`
   - `規格統計(已出貨)`

## 💻 步驟 2：開啟 Apps Script 編輯器

1. 在 Google Sheets 中，點擊頂部選單：**擴充功能** → **Apps Script**
2. 會開啟一個新分頁，顯示 Apps Script 編輯器
3. 刪除預設的 `Code.gs` 中的所有內容

## 📋 步驟 3：貼上後台程式碼

1. 開啟檔案：`COMPLETE-GAS-CODE.js`
2. **全選**並**複製**所有內容（Ctrl+A → Ctrl+C）
3. 回到 Apps Script 編輯器
4. **貼上**程式碼（Ctrl+V）
5. 點擊**儲存**（磁碟圖示或 Ctrl+S）
6. 將專案命名為：**柑心果園後台API**

## 🔐 步驟 4：授權應用程式

### 4.1 授權基本功能
1. 在頂部選擇函數：`onOpen`
2. 點擊**執行**（▶️ 按鈕）
3. 會彈出授權視窗：
   - 點擊**審查權限**
   - 選擇您的 Google 帳戶
   - 點擊**進階**
   - 點擊**前往柑心果園後台API（不安全）**
   - 點擊**允許**

### 4.2 授權 Gmail 寄信功能
1. 在頂部選擇函數：`authorizeGmail_`
2. 點擊**執行**
3. 再次授權（步驟同上）

### 4.3 安裝觸發器
1. 在頂部選擇函數：`setupTriggers`
2. 點擊**執行**
3. 應該會看到提示：「已安裝/更新 onEdit 觸發器。」

## 🌐 步驟 5：部署為網頁應用程式

1. 點擊右上角的**部署** → **新增部署作業**
2. 點擊**選取類型**旁的齒輪圖示 ⚙️
3. 選擇：**網頁應用程式**
4. 填寫設定：
   - **說明**：`柑心果園訂單API v1.0`
   - **執行身分**：選擇「**我**」
   - **存取權**：選擇「**所有人**」
5. 點擊**部署**
6. **重要**：複製「**網頁應用程式網址**」

範例網址：
```
https://script.google.com/macros/s/AKfycbxxxxxxxxxxxxxxxxxxxxx/exec
```

## ✅ 步驟 6：測試連線

1. 開啟新的瀏覽器分頁
2. 在網址列貼上您的網址，並在最後加上 `?ping=1`
   ```
   https://script.google.com/macros/s/AKfycbxxxxx/exec?ping=1
   ```
3. 按 Enter
4. 應該會看到：
   ```json
   {"ok":true,"pong":true}
   ```

**如果看到這個，恭喜！後台部署成功！** 🎉

## 📧 步驟 7：提供網址給我

請將您的網頁應用程式網址告訴我，格式如下：

```
https://script.google.com/macros/s/AKfycbxxxxxxxxxxxxxxxxxxxxx/exec
```

我會幫您更新前端配置，完成串接！

---

## ❓ 常見問題

### Q: 找不到「擴充功能」選單？
**A**: 確保您使用的是新版 Google Sheets。舊版可能顯示為「工具」→「指令碼編輯器」。

### Q: 授權時顯示「此應用程式未經 Google 驗證」？
**A**: 這是正常的，因為這是您自己的應用程式。點擊「進階」→「前往柑心果園後台API（不安全）」即可。

### Q: 測試連線時顯示錯誤？
**A**: 檢查：
1. 是否正確部署為「網頁應用程式」
2. 存取權是否設為「所有人」
3. 網址是否完整（包含 `/exec`）

### Q: 如何重新部署？
**A**: 
1. 修改程式碼後
2. 點擊「部署」→「管理部署作業」
3. 點擊現有部署旁的編輯圖示 ✏️
4. 點擊「版本」→「新版本」
5. 點擊「部署」

---

## 📞 需要協助？

如果遇到任何問題，請提供：
1. 錯誤訊息截圖
2. 您執行到哪一步
3. 瀏覽器 Console 的錯誤訊息（按 F12 開啟）

我會立即協助您解決！
