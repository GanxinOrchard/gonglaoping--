# 🛒 購物車測試指南 - 2025-10-04

## 📋 剛剛修復的問題

### 1. 頁面跳轉後格式異常
**修復內容**：
- ✅ 加強頁面狀態重置邏輯
- ✅ 完全清除 body 的所有樣式屬性（overflow, position, width, height, top, left）
- ✅ 移除所有殘留的 active 類
- ✅ 在頁面載入時強制重置狀態

### 2. 修復位置
**檔案**：`js/cart.js`

**修改 1**：結帳按鈕跳轉前的狀態重置
```javascript
// 完全重置頁面狀態
document.body.style.overflow = '';
document.body.style.position = '';
document.body.style.width = '';

// 移除所有 active 類
document.querySelectorAll('.active').forEach(el => {
    if (el.id !== 'mainMenu') {
        el.classList.remove('active');
    }
});
```

**修改 2**：頁面載入時的狀態重置
```javascript
// 完全重置頁面狀態（解決從其他頁面返回的格式問題）
document.body.style.overflow = '';
document.body.style.position = '';
document.body.style.width = '';
document.body.style.height = '';
document.body.style.top = '';
document.body.style.left = '';
```

---

## 🧪 測試步驟

### 測試 1：基本購物車功能
**目的**：確認購物車開啟/關閉正常

**步驟**：
1. 打開網站首頁
2. 點擊購物車圖示
3. 檢查：購物車側邊欄從右側滑入
4. 檢查：背景有黑色遮罩
5. 點擊遮罩或關閉按鈕
6. 檢查：購物車側邊欄滑出
7. 檢查：遮罩消失
8. 檢查：頁面可以正常滾動

**預期結果**：✅ 所有功能正常

---

### 測試 2：添加商品到購物車
**目的**：確認商品可以正常添加

**步驟**：
1. 在首頁選擇一個商品
2. 點擊「加入購物車」
3. 檢查：顯示「已加入購物車！」通知
4. 檢查：購物車圖示上的數字增加
5. 打開購物車側邊欄
6. 檢查：商品顯示在列表中
7. 檢查：價格計算正確
8. 檢查：運費顯示正確（＜1800 顯示 NT$150）

**預期結果**：✅ 所有功能正常

---

### 測試 3：頁面跳轉後格式問題（重點測試）
**目的**：確認從購物車→結帳→首頁→結帳的格式正常

**步驟**：
1. 添加商品到購物車
2. 打開購物車側邊欄
3. 點擊「前往結帳」按鈕
4. 等待跳轉到結帳頁面
5. **檢查 A**：結帳頁面格式正常
6. **檢查 B**：頁面可以正常滾動
7. **檢查 C**：訂單摘要顯示正確
8. 點擊瀏覽器的「返回」按鈕或導航欄的「首頁」
9. 返回首頁
10. **檢查 D**：首頁格式正常
11. **檢查 E**：首頁可以正常滾動
12. 再次打開購物車側邊欄
13. 再次點擊「前往結帳」
14. **重點檢查 F**：結帳頁面格式是否與第一次一樣
15. **重點檢查 G**：頁面是否可以正常滾動
16. **重點檢查 H**：沒有任何奇怪的樣式（如頁面被壓縮、無法滾動等）

**預期結果**：✅ 所有檢查點都正常

---

### 測試 4：手機版購物車
**目的**：確認手機版購物車正常

**步驟**：
1. 打開開發者工具（F12）
2. 切換到手機模擬模式（Ctrl + Shift + M）
3. 選擇 iPhone 或 Android 設備
4. 重複測試 1、2、3 的所有步驟
5. 特別檢查：
   - 購物車側邊欄佔滿整個螢幕寬度
   - 遮罩正常顯示
   - 滾動正常
   - 格式正常

**預期結果**：✅ 手機版功能完全正常

---

### 測試 5：網頁版購物車（不同螢幕寬度）
**目的**：確認不同螢幕寬度下購物車正常

**測試寬度**：
- 1920px（全高清）
- 1366px（筆記本）
- 1024px（平板橫向）
- 768px（平板直向）
- 375px（手機）

**步驟**：
1. 調整瀏覽器寬度到上述尺寸
2. 重複測試 1、2、3 的所有步驟
3. 檢查每個寬度下的顯示是否正常

**預期結果**：✅ 所有寬度下都正常

---

## 🔍 常見問題排查

### 問題 A：頁面無法滾動
**可能原因**：body 的 overflow 屬性未重置
**解決方法**：
1. 打開開發者工具（F12）
2. 在 Console 輸入：`document.body.style.overflow = ''`
3. 按 Enter
4. 檢查是否恢復正常
5. 如果恢復正常，說明是狀態重置問題，需要清除緩存並硬刷新

### 問題 B：購物車側邊欄不顯示
**可能原因**：z-index 問題或 CSS 未載入
**解決方法**：
1. 打開開發者工具（F12）
2. 檢查 Console 是否有錯誤
3. 檢查 Network 標籤，確認 CSS 和 JS 都已載入
4. 執行硬刷新（Ctrl + Shift + R）

### 問題 C：格式異常或樣式錯亂
**可能原因**：瀏覽器緩存
**解決方法**：
1. 執行硬刷新（Ctrl + Shift + R 或 Ctrl + F5）
2. 或清除瀏覽器緩存：
   - 打開開發者工具（F12）
   - 右鍵點擊刷新按鈕
   - 選擇「清空緩存並硬性重新載入」

---

## ✅ 測試檢查表

複製以下清單，完成測試後打勾：

```
購物車基本功能
[ ] 購物車開啟正常
[ ] 購物車關閉正常
[ ] 遮罩顯示正常
[ ] 頁面滾動正常

添加商品功能
[ ] 商品可以添加
[ ] 數量顯示正確
[ ] 價格計算正確
[ ] 運費計算正確

頁面跳轉測試（重點）
[ ] 首次進入結帳頁面格式正常
[ ] 返回首頁格式正常
[ ] 再次進入結帳頁面格式正常
[ ] 所有步驟頁面都可滾動
[ ] 沒有樣式錯亂

手機版測試
[ ] iPhone 顯示正常
[ ] Android 顯示正常
[ ] 側邊欄佔滿寬度
[ ] 所有功能正常

不同寬度測試
[ ] 1920px 正常
[ ] 1366px 正常
[ ] 1024px 正常
[ ] 768px 正常
[ ] 375px 正常
```

---

## 🚀 測試完成後

**如果所有測試都通過**：
✅ 購物車問題已完全修復！

**如果還有問題**：
1. 記錄具體的問題現象
2. 記錄出現問題的步驟
3. 記錄瀏覽器和螢幕寬度
4. 記錄 Console 中的錯誤訊息
5. 提供以上資訊以便進一步診斷

---

**測試時間**：約 15-20 分鐘  
**建議瀏覽器**：Chrome 或 Edge（最新版本）  
**重要提示**：測試前請先執行硬刷新（Ctrl + Shift + R）確保使用最新版本！
