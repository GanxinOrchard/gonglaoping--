<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è³¼ç‰©è»ŠåŠŸèƒ½æ¸¬è©¦</title>
    <link rel="stylesheet" href="./css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .debug-panel {
            position: fixed;
            top: 10px;
            left: 10px;
            background: white;
            padding: 20px;
            border: 2px solid #333;
            border-radius: 8px;
            z-index: 99999;
            max-width: 400px;
            font-size: 14px;
        }
        .debug-panel h3 {
            margin: 0 0 10px 0;
            color: #ff8c42;
        }
        .debug-item {
            margin: 5px 0;
            padding: 5px;
            background: #f5f5f5;
            border-radius: 4px;
        }
        .ok { color: green; }
        .error { color: red; }
    </style>
</head>
<body>
    <div class="debug-panel">
        <h3>ğŸ” è³¼ç‰©è»ŠåŠŸèƒ½è¨ºæ–·</h3>
        <div id="debugOutput"></div>
        <button onclick="testCart()" style="margin-top: 10px; padding: 10px; background: #ff8c42; color: white; border: none; border-radius: 4px; cursor: pointer;">
            é‡æ–°æ¸¬è©¦
        </button>
    </div>

    <!-- æ‡¸æµ®è³¼ç‰©è»ŠæŒ‰éˆ• -->
    <div class="floating-cart-btn" id="floatingCartBtn">
        <i class="fas fa-shopping-cart"></i>
        <span class="cart-badge" id="floatingCartCount">0</span>
    </div>

    <!-- è³¼ç‰©è»Šå´é‚Šæ¬„ -->
    <div class="cart-sidebar" id="cartSidebar">
        <div class="cart-header">
            <h3>è³¼ç‰©è»Š</h3>
            <button class="close-cart" id="closeCart">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="cart-items" id="cartItems">
            <p>è³¼ç‰©è»Šæ˜¯ç©ºçš„</p>
        </div>
        <div class="cart-footer">
            <div class="cart-total">
                <div class="total">
                    <span>ç¸½è¨ˆï¼š</span>
                    <span id="total">NT$ 0</span>
                </div>
            </div>
            <button class="btn-checkout" id="checkoutBtn">å‰å¾€çµå¸³</button>
        </div>
    </div>

    <script src="./js/products.js"></script>
    <script src="./js/cart.js"></script>
    <script src="./js/main.js"></script>
    
    <script>
        function testCart() {
            const output = document.getElementById('debugOutput');
            let html = '';
            
            // æ¸¬è©¦ 1: æª¢æŸ¥å…ƒç´ 
            html += '<div class="debug-item"><strong>1. å…ƒç´ æª¢æŸ¥ï¼š</strong><br>';
            const floatingCartBtn = document.getElementById('floatingCartBtn');
            const cartSidebar = document.getElementById('cartSidebar');
            const closeCart = document.getElementById('closeCart');
            
            html += floatingCartBtn ? '<span class="ok">âœ“ floatingCartBtn å­˜åœ¨</span><br>' : '<span class="error">âœ— floatingCartBtn ä¸å­˜åœ¨</span><br>';
            html += cartSidebar ? '<span class="ok">âœ“ cartSidebar å­˜åœ¨</span><br>' : '<span class="error">âœ— cartSidebar ä¸å­˜åœ¨</span><br>';
            html += closeCart ? '<span class="ok">âœ“ closeCart å­˜åœ¨</span><br>' : '<span class="error">âœ— closeCart ä¸å­˜åœ¨</span><br>';
            html += '</div>';
            
            // æ¸¬è©¦ 2: æª¢æŸ¥äº‹ä»¶ç›£è½å™¨
            html += '<div class="debug-item"><strong>2. äº‹ä»¶ç›£è½å™¨ï¼š</strong><br>';
            if (floatingCartBtn) {
                const listeners = getEventListeners ? getEventListeners(floatingCartBtn) : null;
                html += listeners ? `<span class="ok">âœ“ æœ‰äº‹ä»¶ç›£è½å™¨</span><br>` : '<span>ç„¡æ³•æª¢æ¸¬äº‹ä»¶ç›£è½å™¨ï¼ˆéœ€è¦é–‹ç™¼è€…å·¥å…·ï¼‰</span><br>';
            }
            html += '</div>';
            
            // æ¸¬è©¦ 3: æ‰‹å‹•è§¸ç™¼
            html += '<div class="debug-item"><strong>3. æ‰‹å‹•æ¸¬è©¦ï¼š</strong><br>';
            html += '<button onclick="manualOpenCart()" style="padding: 5px 10px; margin: 5px; background: #27ae60; color: white; border: none; border-radius: 4px; cursor: pointer;">æ‰‹å‹•é–‹å•Ÿè³¼ç‰©è»Š</button><br>';
            html += '</div>';
            
            // æ¸¬è©¦ 4: CSS æª¢æŸ¥
            html += '<div class="debug-item"><strong>4. CSS ç‹€æ…‹ï¼š</strong><br>';
            if (floatingCartBtn) {
                const style = window.getComputedStyle(floatingCartBtn);
                html += `display: ${style.display}<br>`;
                html += `visibility: ${style.visibility}<br>`;
                html += `z-index: ${style.zIndex}<br>`;
                html += `position: ${style.position}<br>`;
            }
            html += '</div>';
            
            // æ¸¬è©¦ 5: JavaScript éŒ¯èª¤
            html += '<div class="debug-item"><strong>5. æ§åˆ¶å°è¨Šæ¯ï¼š</strong><br>';
            html += 'è«‹æ‰“é–‹ç€è¦½å™¨æ§åˆ¶å° (F12) æŸ¥çœ‹éŒ¯èª¤è¨Šæ¯';
            html += '</div>';
            
            output.innerHTML = html;
        }
        
        function manualOpenCart() {
            const cartSidebar = document.getElementById('cartSidebar');
            if (cartSidebar) {
                cartSidebar.classList.add('active');
                alert('è³¼ç‰©è»Šå·²é–‹å•Ÿï¼å¦‚æœçœ‹ä¸åˆ°ï¼Œå¯èƒ½æ˜¯ CSS å•é¡Œã€‚');
            } else {
                alert('æ‰¾ä¸åˆ°è³¼ç‰©è»Šå…ƒç´ ï¼');
            }
        }
        
        // é é¢è¼‰å…¥å¾Œè‡ªå‹•æ¸¬è©¦
        window.addEventListener('load', () => {
            setTimeout(testCart, 1000);
        });
        
        // ç›£è½é»æ“Šäº‹ä»¶
        document.addEventListener('click', (e) => {
            console.log('é»æ“Šäº‹ä»¶:', e.target);
            if (e.target.closest('#floatingCartBtn')) {
                console.log('é»æ“Šäº†æ‡¸æµ®è³¼ç‰©è»ŠæŒ‰éˆ•');
            }
        }, true);
    </script>
</body>
</html>
